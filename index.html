<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindos - Your Modern E-commerce Store</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            color: #333;
            background-image: url('images/background.jpg');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: auto;
        }

        .hidden {
            display: none;
        }
        
        .page {
            min-height: calc(100vh - 80px); /* Adjust for header height */
        }
        .btn-primary {
            background-color: #4f46e5;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
        }

        .btn-primary:hover {
            background-color: #4338ca;
            transform: scale(1.05);
        }
        .btn-secondary {
            background-color: #e5e7eb;
            color: #4f46e5;
            padding: 0.5rem 1rem;
            border-radius: 9999px;
            font-weight: 600;
            transition: all 0.2s ease-in-out;
        }
        .btn-secondary:hover {
            background-color: #d1d5db;
        }
        .product-card {
            display: flex;
            flex-direction: column;
            height: 100%;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        .category-button.active {
            background-color: #4f46e5;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .try-on-viewer {
            position: relative;
            width: 100%;
            height: 500px;
            background-color: #f3f4f6;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        #model-viewer-container {
            width: 100%;
            height: 100%;
            border-radius: 12px;
        }

        #mobile-nav {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }
        #mobile-nav.open {
            transform: translateX(0);
        }
        .profile-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #4f46e5;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.875rem;
        }
        /* Loading Screen CSS */
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #fefefe;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 0.5s ease;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border-left-color: #4f46e5;
            animation: spin 1.2s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        #skeleton-preview {
            width: 80%;
            max-width: 800px;
            height: 300px;
            background-color: #e0e0e0;
            border-radius: 8px;
            animation: pulse 1.5s infinite;
            margin-top: 2rem;
            transition: opacity 0.5s ease;
        }
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 0.8; }
            100% { opacity: 0.6; }
        }
    </style>
</head>
<body>
    
    <div id="loading-screen" class="flex flex-col items-center justify-center space-y-4">
        <div class="spinner"></div>
        <p class="text-gray-600 font-semibold text-lg">Loading Experience...</p>
        <div id="skeleton-preview"></div>
    </div>


    <header class="bg-white/90 backdrop-blur-sm shadow-md py-4 sticky top-0 z-50">
        <nav class="container mx-auto flex justify-between items-center px-4">
            <a href="#home" class="text-2xl font-bold text-indigo-600">Mindos</a>
            <div class="hidden sm:flex space-x-6">
                <a href="#home" class="text-gray-600 hover:text-indigo-600 font-medium">Home</a>
                <a href="#products" class="text-gray-600 hover:text-indigo-600 font-medium">Products</a>
                <a href="#try-on" class="text-gray-600 hover:text-indigo-600 font-medium">Try-On</a>
                <a href="#about" class="text-gray-600 hover:text-indigo-600 font-medium">About</a>
                <a href="#feedback" class="text-gray-600 hover:text-indigo-600 font-medium">Feedback</a>
            </div>
            <div class="flex items-center space-x-4">
                <button onclick="showPage('cart')" class="relative text-gray-600 hover:text-indigo-600">
                    <i class="fas fa-shopping-cart text-xl"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full text-xs w-5 h-5 flex items-center justify-center">0</span>
                </button>
                <button id="mobile-menu-button" class="sm:hidden text-gray-600 hover:text-indigo-600">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </nav>
    </header>

    <div id="mobile-nav" class="fixed inset-y-0 right-0 w-64 bg-white shadow-xl z-50 transform translate-x-full transition-transform ease-in-out duration-300 sm:hidden">
        <div class="p-6">
            <button id="close-menu-button" class="absolute top-4 right-4 text-gray-600 hover:text-indigo-600">
                <i class="fas fa-times text-xl"></i>
            </button>
            <nav class="flex flex-col space-y-6 mt-8 text-lg">
                <a href="#home" class="text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">Home</a>
                <a href="#products" class="text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">Products</a>
                <a href="#try-on" class="text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">Try-On</a>
                <a href="#about" class="text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">About</a>
                <a href="#feedback" class="text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">Feedback</a>
                <a href="#cart" class="flex items-center text-gray-800 hover:text-indigo-600 font-semibold" onclick="toggleMobileMenu()">
                    <i class="fas fa-shopping-cart text-xl mr-2"></i>
                    Cart (<span id="mobile-cart-count">0</span>)
                </a>
            </nav>
        </div>
    </div>


    <main class="relative z-10">

        <section id="home-page" class="page hidden pt-12 pb-24 text-center">
            <div class="container mx-auto px-4">
                <h1 class="text-4xl sm:text-6xl font-extrabold text-gray-900 leading-tight">Welcome to <span class="text-indigo-600">Mindos</span></h1>
                <p class="mt-4 text-lg sm:text-xl text-gray-700 max-w-2xl mx-auto">Discover the latest trends in technology, fashion, and home goods. Experience a new way to shop with our AI-powered virtual try-on.</p>
                <div class="mt-8 flex justify-center space-x-4">
                    <a href="#products" class="btn-primary text-lg px-8 py-3 rounded-full">Shop Now</a>
                    <a href="#try-on" class="btn-secondary text-lg px-8 py-3 rounded-full">Try It Out</a>
                </div>
            </div>

            <div class="bg-white bg-opacity-80 backdrop-blur-sm rounded-xl shadow-lg mt-16 p-8 mx-auto max-w-4xl">
                <h2 class="text-2xl font-bold text-center text-gray-800 mb-6">What Our Customers Say</h2>
                <div id="home-ratings-list" class="flex overflow-x-auto space-x-6 pb-4 scrollbar-hidden">
                    </div>
            </div>

        </section>

        <section id="products-page" class="page hidden pt-12 pb-24">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Featured Products</h2>
                <div class="flex flex-wrap justify-center space-x-2 sm:space-x-4 mb-8">
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('All', this)">All</button>
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('Electronics', this)">Electronics</button>
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('Furniture', this)">Furniture</button>
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('Home & Kitchen', this)">Home & Kitchen</button>
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('Men\'s Collection', this)">Men's Collection</button>
                    <button class="category-button btn-secondary px-4 py-2 rounded-full font-semibold" onclick="filterProducts('Women\'s Collection', this)">Women's Collection</button>
                </div>
                <div id="product-list" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-6">
                    </div>
            </div>
        </section>

        <section id="try-on-page" class="page hidden pt-12 pb-24">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Virtual Try-On</h2>
                
                <div class="mb-8 flex justify-center items-center">
                    <label for="tryOnProductSelect" class="mr-4 text-lg font-medium text-gray-700">Choose a model:</label>
                    <select id="tryOnProductSelect" class="p-2 border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 w-64"></select>
                </div>

                <div class="try-on-viewer">
                    <model-viewer id="main-model-viewer"
                        class="w-full h-full"
                        ar
                        ar-modes="webxr scene-viewer quick-look"
                        camera-controls
                        shadow-intensity="1"
                        auto-rotate
                        alt="A 3D model of a product"
                        xr-environment
                        loading="eager"
                        >
                    </model-viewer>
                </div>
                
            </div>
        </section>


        <section id="about-page" class="page hidden pt-12 pb-24">
            <div class="container mx-auto px-4">
                <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-8 sm:p-12">
                    <h2 class="text-3xl font-bold text-center text-gray-900 mb-6">About Mindos</h2>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6">
                        Mindos is at the forefront of a new era in e-commerce, blending technology and shopping to create a truly immersive experience. Our mission is to empower you with the tools to make confident purchasing decisions, all from the comfort of your home.
                    </p>
                    <p class="text-lg text-gray-700 leading-relaxed mb-6">
                        Our platform is built on innovative AI and cognitive principles. We track user behavior, analyze preferences, and adapt our interface to match your unique shopping style, whether you're a "Quick Scanner" or a "Detailed Explorer."
                    </p>
                    <p class="text-lg text-gray-700 leading-relaxed">
                        The core of our platform is the Virtual Try-On feature. Using advanced 3D modeling and augmented reality, you can see how products, from furniture to accessories, look in your own space before you buy. This technology reduces uncertainty and enhances your shopping journey.
                    </p>
                </div>
            </div>
        </section>

        <section id="feedback-page" class="page hidden pt-12 pb-24">
            <div class="container mx-auto px-4">
                <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-8 sm:p-12 max-w-3xl mx-auto">
                    <h2 class="text-3xl font-bold text-center text-gray-900 mb-6">Share Your Feedback</h2>
                    <p class="text-center text-gray-600 mb-8">Your opinion helps us improve. Please share your experience with us.</p>
                    <form id="feedback-form" class="space-y-6">
                        <div>
                            <label for="feedbackName" class="block text-sm font-medium text-gray-700">Name</label>
                            <input type="text" id="feedbackName" name="feedbackName" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="feedbackEmail" class="block text-sm font-medium text-gray-700">Email</label>
                            <input type="email" id="feedbackEmail" name="feedbackEmail" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                        </div>
                        <div>
                            <label for="feedbackRating" class="block text-sm font-medium text-gray-700">Rating (1-5)</label>
                            <select id="feedbackRating" name="feedbackRating" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                                <option value="">Select a rating</option>
                                <option value="5">5 - Excellent</option>
                                <option value="4">4 - Very Good</option>
                                <option value="3">3 - Good</option>
                                <option value="2">2 - Fair</option>
                                <option value="1">1 - Poor</option>
                            </select>
                        </div>
                        <div>
                            <label for="feedbackComments" class="block text-sm font-medium text-gray-700">Comments</label>
                            <textarea id="feedbackComments" name="feedbackComments" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn-primary w-full py-2">Submit Feedback</button>
                        </div>
                    </form>
                    <div id="feedback-list" class="mt-10">
                        <p id="no-feedback-message" class="text-center text-gray-500 hidden">No feedback has been submitted yet.</p>
                    </div>
                </div>
            </div>
        </section>


        <section id="cart-page" class="page hidden pt-12 pb-24">
            <div class="container mx-auto px-4">
                <div class="bg-white/90 backdrop-blur-sm rounded-xl shadow-lg p-8 sm:p-12">
                    <h2 class="text-3xl font-bold text-center text-gray-900 mb-6">Your Shopping Cart</h2>
                    <div id="cart-items" class="divide-y divide-gray-200">
                        </div>
                    <p id="empty-cart-message" class="text-center text-gray-500 mt-4 text-lg hidden">Your cart is empty.</p>
                    <div class="mt-8 flex justify-end items-center">
                        <span class="text-xl font-bold text-gray-800 mr-4">Total: <span id="cart-total">$0.00</span></span>
                    </div>
                    <div class="mt-8">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Checkout Information</h3>
                        <form id="checkout-form" class="space-y-4">
                            <div>
                                <label for="checkoutName" class="block text-sm font-medium text-gray-700">Full Name</label>
                                <input type="text" id="checkoutName" name="name" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label for="checkoutEmail" class="block text-sm font-medium text-gray-700">Email</label>
                                <input type="email" id="checkoutEmail" name="email" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>
                            <div>
                                <label for="checkoutAddress" class="block text-sm font-medium text-gray-700">Shipping Address</label>
                                <textarea id="checkoutAddress" name="address" rows="3" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                            </div>
                            <button type="submit" class="btn-primary w-full py-3">Proceed to Checkout</button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div id="message-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden transition-opacity duration-300 z-50">
        <div class="bg-white rounded-lg shadow-xl p-8 max-w-sm mx-auto text-center transform scale-95 transition-transform duration-300">
            <h3 id="modal-title" class="text-2xl font-bold mb-4"></h3>
            <p id="modal-message" class="text-gray-700 mb-6"></p>
            <button onclick="closeModal()" class="btn-primary py-2 px-6">OK</button>
        </div>
    </div>


    <script>
        // --- Global State ---
        let products = [
            { id: 1, name: "Men's Casual T-Shirt", price: 25.00, image: "images/tshirtmen.jpg", description: "Comfortable and stylish cotton t-shirt for everyday wear.", category: "Men's Collection", modelPath: "models/tshirtmen.glb" },
            { id: 2, name: "Wireless Noise-Cancelling Headphones", price: 149.99, image: "images/headphone.jpg", description: "Immerse yourself in pure sound with these comfortable headphones.", category: "Electronics", modelPath: "models/headphone.glb" },
            { id: 3, name: "Ergonomic Office Chair", price: 299.99, image: "images/chair.jpg", description: "Work in comfort and style with our premium ergonomic chair.", category: "Furniture", modelPath: "models/chair.glb" },
            { id: 4, name: "Portable Bluetooth Speaker", price: 79.99, image: "images/speaker.jpg", description: "Enjoy high-quality audio on the go with this compact speaker.", category: "Electronics", modelPath: "models/speaker.glb" },
            { id: 5, name: "Stylish Smartwatch", price: 199.99, image: "images/smartwatch.jpg", description: "Stay connected and track your fitness with this elegant smartwatch.", category: "Electronics", modelPath: "models/smartwatch.glb" },
            { id: 6, name: "Smart Home Hub", price: 129.99, image: "images/homehub.jpg", description: "Control all your smart devices from one central hub.", category: "Electronics", modelPath: "models/homehub.glb" },
            { id: 7, name: "Espresso Machine", price: 219.99, image: "images/expresso.jpg", description: "Brew the perfect espresso at home with ease.", category: "Home & Kitchen", modelPath: "models/espresso.glb" },
            { id: 8, name: "Mechanical Gaming Keyboard", price: 99.99, image: "images/keyboard.jpg", description: "Responsive mechanical keys for a superior gaming experience.", category: "Electronics", modelPath: "models/keyboard.glb" },
            { id: 9, name: "Classic Sunglasses", price: 49.99, image: "images/sunglassesjpg.jpg", description: "Timeless style and UV protection for your eyes.", category: "Men's Collection", modelPath: "models/sunglasses.glb" },
            { id: 10, name: "Baseball Cap", price: 29.99, image: "images/cap.jpg", description: "Sporty and comfortable, perfect for any outdoor activity.", category: "Men's Collection", modelPath: "models/cap.glb" },
            { id: 11, name: "Women's Silk Scarf", price: 39.99, image: "images/scarf.jpg", description: "Add a touch of elegance to your outfit.", category: "Women's Collection", modelPath: "models/scarf.glb" },
            { id: 12, name: "Fitness Tracker Band", price: 79.99, image: "images/band.jpg", description: "Monitor your health and activity with precision.", category: "Electronics", modelPath: "models/band.glb" },
            { id: 13, name: "Modern Desk Lamp", price: 59.99, image: "images/lamp.jpg", description: "Illuminate your workspace with this sleek and adjustable lamp.", category: "Furniture", modelPath: "models/lamp.glb" },
            { id: 14, name: "Comfortable Sofa", price: 799.99, image: "images/sofa.jpg", description: "Relax in ultimate comfort with our plush and modern sofa.", category: "Furniture", modelPath: "models/sofa.glb" },
            { id: 15, name: "Elegant Evening Dress", price: 120.00, image: "images/dress.jpg", description: "A stunning dress for any special occasion.", category: "Women's Collection", modelPath: "models/dress.glb" },
            { id: 16, name: "Men's Leather Wallet", price: 45.00, image: "images/wallet.jpg", description: "Durable and stylish leather wallet with multiple compartments.", category: "Men's Collection", modelPath: "models/wallet.glb" },
            { id: 17, name: "Women's Summer Hat", price: 35.00, image: "images/hat.jpg", description: "Lightweight and fashionable hat for sunny days.", category: "Women's Collection", modelPath: "models/hat.glb" },
            { id: 18, name: "Men's Formal Shirt", price: 55.00, image: "images/shirt.jpg", description: "Crisp and comfortable shirt perfect for office or events.", category: "Men's Collection", modelPath: "models/shirt.glb" },
            { id: 19, name: "Women's Handbag", price: 85.00, image: "images/handbag.jpg", description: "Spacious and elegant handbag for everyday essentials.", category: "Women's Collection", modelPath: "models/handbag.glb" },
            { id: 20, name: "Smart Vacuum Cleaner", price: 349.99, image: "images/vacuumcleaner.jpg", description: "Effortlessly clean your home with this intelligent robot vacuum.", category: "Home & Kitchen", modelPath: "models/vacuumcleaner.glb" },
            { id: 21, name: "Men's Running Shoes", price: 75.00, image: "images/runningshoes.jpg", description: "Lightweight and supportive shoes for your daily runs.", category: "Men's Collection", modelPath: "models/runningshoes.glb" },
            { id: 22, name: "Women's Yoga Pants", price: 40.00, image: "images/legging.jpg", description: "Comfortable and flexible yoga pants for your workout.", category: "Women's Collection", modelPath: "models/legging.glb" },
            { id: 23, name: "Bookshelf", price: 150.00, image: "images/bookshelf.jpg", description: "Stylish and sturdy bookshelf for your living room.", category: "Furniture", modelPath: "models/bookshelf.glb" },
            { id: 24, name: "Smart Coffee Mug", price: 45.00, image: "images/coffeemug.jpg", description: "Keep your coffee at the perfect temperature all day.", category: "Home & Kitchen", modelPath: "models/coffeemug.glb" },
            { id: 25, name: "Luxury Sectional Sofa", price: 1299.99, image: "images/luxury-sectional-sofa.jpg", description: "Spacious and luxurious sectional sofa for ultimate living room comfort.", category: "Furniture", modelPath: "models/WhiteSofa.glb" },
            { id: 26, name: "Mid-Century Modern Sofa", price: 899.99, image: "images/mid-century-sofa.jpg", description: "A stylish sofa with a timeless design, perfect for any contemporary space.", category: "Furniture", modelPath: "models/LightBrownSofa.glb" },
            { id: 27, name: "Compact Apartment Sofa", price: 549.99, image: "images/compact-sofa.jpg", description: "Ideal for smaller spaces, this sofa offers comfort without compromising on style.", category: "Furniture", modelPath: "models/BrownSofa.glb" },
            { id: 28, name: "King Size Platform Bed", price: 699.99, image: "images/king-bed.jpg", description: "A sturdy and elegant king size platform bed, perfect for a master bedroom.", category: "Furniture", modelPath: "models/kingbed.glb" }
        ];

        let cart = [];
        // Pre-populated feedback entries
        let feedbackEntries = [
            { name: "Alice Smith", email: "alice@example.com", rating: 5, comments: "Absolutely love the range of products! The virtual try-on is a game changer.", date: "07/01/2025" },
            { name: "Bob Johnson", email: "bob@example.com", rating: 4, comments: "Great website design and easy to navigate. Shipping was fast.", date: "06/28/2025" },
            { name: "Charlie Brown", email: "charlie@example.com", rating: 5, comments: "Mindos has become my go-to for electronics. Highly recommend!", date: "06/25/2025" },
            { name: "Diana Prince", email: "diana@example.com", rating: 3, comments: "Good selection, but I wish there were more detailed product descriptions.", date: "06/20/2025" }
        ];

        // --- DOM Elements ---
        const productListDiv = document.getElementById('product-list');
        const cartItemsDiv = document.getElementById('cart-items');
        const cartTotalSpan = document.getElementById('cart-total');
        const cartCountSpan = document.getElementById('cart-count');
        const emptyCartMessage = document.getElementById('empty-cart-message');
        const checkoutForm = document.getElementById('checkout-form');
        const messageModal = document.getElementById('message-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const feedbackForm = document.getElementById('feedback-form');
        const feedbackListDiv = document.getElementById('feedback-list');
        const noFeedbackMessage = document.getElementById('no-feedback-message');
        const homeRatingsListDiv = document.getElementById('home-ratings-list'); // New DOM element for home page ratings
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const closeMenuButton = document.getElementById('close-menu-button');
        const mobileNav = document.getElementById('mobile-nav');
        const mobileCartCount = document.getElementById('mobile-cart-count');

        // New DOM element for the main model-viewer
        const mainModelViewer = document.getElementById('main-model-viewer');
        const tryOnProductSelect = document.getElementById('tryOnProductSelect');

        // --- Page Navigation ---
        function showPage(pageId, productIdToTryOn = null) {
            // 🔁 Update the URL hash without duplicating
            if (window.location.hash.replace("#", "") !== pageId) {
                window.location.hash = pageId;
            }

            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });

            const targetSection = document.getElementById(`${pageId}-page`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }

            // Specific page behavior
            if (pageId === 'home') {
                filterProducts('All', document.querySelector('.category-button[data-category="All"]'));
                renderHomeRatings();
            } else if (pageId === 'cart') {
                renderCart();
            } else if (pageId === 'try-on') {
                populateTryOnProductSelect();
                if (productIdToTryOn) {
                    showTryOnPage(parseInt(productIdToTryOn));
                }
            } else if (pageId === 'feedback') {
                renderFeedback();
            } else if (pageId === 'about') {
                // no special logic needed, just reveal section
            }
        }


        // --- Mobile Menu Toggle ---
        function toggleMobileMenu() {
            mobileNav.classList.toggle('hidden');
            mobileNav.classList.toggle('flex');
            mobileNav.classList.toggle('open'); // For CSS transition
            // Update cart count in mobile menu
            mobileCartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);

            // Prevent scrolling when mobile menu is open
            if (mobileNav.classList.contains('open')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = '';
            }
        }

        mobileMenuButton.addEventListener('click', toggleMobileMenu);
        closeMenuButton.addEventListener('click', toggleMobileMenu);


        // --- Product Filtering and Rendering ---
        function filterProducts(category, clickedButton) {
            // Remove active class from all category buttons
            document.querySelectorAll('.category-button').forEach(button => {
                button.classList.remove('active');
            });
            // Add active class to the clicked button
            if (clickedButton) {
                clickedButton.classList.add('active');
            }

            const filteredProducts = category === 'All' ? products : products.filter(p => p.category === category);
            renderProducts(filteredProducts);
        }

        function renderProducts(productsToRender) {
            productListDiv.innerHTML = ''; // Clear existing products

            productsToRender.forEach(product => {
                const tryOnButton = product.modelPath ?
                    `
                        <button class="btn-secondary py-1 px-3 rounded-full text-xs sm:text-sm font-semibold" onclick="showPage('try-on', ${product.id})">
                            Try On
                        </button>
                    `
                    : '';

                const productCard = `
                    <div class="product-card bg-white rounded-lg shadow-md flex flex-col p-3 sm:p-6 h-full">
                        <img src="${product.image}" alt="${product.name}" class="w-full h-[130px] sm:h-[260px] object-cover rounded-md mb-2">
                        <h3 class="text-sm sm:text-base font-semibold text-gray-800 mb-1 line-clamp-2">${product.name}</h3>
                        <p class="text-gray-600 text-xs sm:text-sm mb-2 line-clamp-2">${product.description}</p>
                        <div class="flex justify-between items-center mt-auto">
                            <span class="text-sm sm:text-lg font-bold text-indigo-600">$${product.price.toFixed(2)}</span>
                            <div class="flex flex-col space-y-1">
                                <button class="btn-primary text-white py-1 px-3 rounded-full text-xs sm:text-sm font-semibold" onclick="addToCart(${product.id})">
                                    Add to Cart
                                </button>
                                ${tryOnButton}
                            </div>
                        </div>
                    </div>
                `;

                productListDiv.innerHTML += productCard;
            });
        }



        // --- Cart Functions ---
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity++;
                } else {
                    cart.push({ ...product, quantity: 1 });
                }
                updateCartUI();
                showModal('Success!', `${product.name} added to cart.`, 'success');
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
        }

        function updateQuantity(productId, change) {
            const item = cart.find(item => item.id === productId);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromCart(productId);
                } else {
                    updateCartUI();
                }
            }
        }

        function updateCartUI() {
            cartItemsDiv.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                emptyCartMessage.classList.remove('hidden');
            } else {
                emptyCartMessage.classList.add('hidden');
                cart.forEach(item => {
                    const itemTotal = item.price * item.quantity;
                    total += itemTotal;
                    const cartItemHtml = `
                        <div class="flex items-center justify-between border-b border-gray-200 py-4 last:border-b-0">
                            <div class="flex items-center">
                                <img src="${item.image}" alt="${item.name}" class="w-20 h-20 object-cover rounded-lg mr-4">
                                <div>
                                    <h4 class="text-lg font-medium text-gray-800">${item.name}</h4>
                                    <p class="text-gray-600">$${item.price.toFixed(2)}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3">
                                <button class="btn-secondary w-8 h-8 rounded-full flex items-center justify-center text-lg" onclick="updateQuantity(${item.id}, -1)">-</button>
                                <span class="text-lg font-semibold text-gray-800">${item.quantity}</span>
                                <button class="btn-secondary w-8 h-8 rounded-full flex items-center justify-center text-lg" onclick="updateQuantity(${item.id}, 1)">+</button>
                            </div>
                            <div class="text-xl font-bold text-indigo-600">$${itemTotal.toFixed(2)}</div>
                            <button class="text-red-500 hover:text-red-700 transition duration-300" onclick="removeFromCart(${item.id})">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    `;
                    cartItemsDiv.innerHTML += cartItemHtml;
                });
            }

            cartTotalSpan.textContent = `$${total.toFixed(2)}`;
            const currentCartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            cartCountSpan.textContent = currentCartCount;
            mobileCartCount.textContent = currentCartCount; // Update mobile cart count


            localStorage.setItem("cartData", JSON.stringify(cart));
        }

        function renderCart() {
            updateCartUI();
        }

        // --- Checkout Form Submission (Simulated Payment) ---
        checkoutForm.addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission

            // Simulate payment processing
            const isPaymentSuccessful = Math.random() > 0.1; // 90% chance of success

            if (isPaymentSuccessful) {
                showModal('Order Placed!', 'Your order has been successfully placed. Thank you for shopping with us!', 'success');
                cart = []; // Clear cart after successful order
                updateCartUI();
                checkoutForm.reset(); // Clear form fields
                setTimeout(() => showPage('home'), 2000); // Redirect to home after 2 seconds
            } else {
                showModal('Payment Failed!', 'There was an issue processing your payment. Please try again or use a different card.', 'error');
            }
        });

        // --- Modal Functions ---
        function showModal(title, message, type) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            if (type === 'success') {
                modalTitle.classList.remove('text-red-600');
                modalTitle.classList.add('text-green-600');
            } else if (type === 'error') {
                modalTitle.classList.remove('text-green-600');
                modalTitle.classList.add('text-red-600');
            }
            messageModal.classList.remove('hidden');
            // Animate modal in
            setTimeout(() => {
                messageModal.querySelector('div').classList.remove('scale-95');
                messageModal.querySelector('div').classList.add('scale-100');
            }, 50);
        }

        function closeModal() {
            // Animate modal out
            messageModal.querySelector('div').classList.remove('scale-100');
            messageModal.querySelector('div').classList.add('scale-95');
            setTimeout(() => {
                messageModal.classList.add('hidden');
            }, 300); // Match transition duration
        }

        // --- Cognitive AI: User Behavior Tracking ---
        let userBehavior = {
            scrollDepth: 0,
            clicks: 0,
            timeSpent: 0
        };

        let timeStart = Date.now();

        window.addEventListener("scroll", () => {
            const scrolled = window.scrollY + window.innerHeight;
            const totalHeight = document.body.offsetHeight;
            userBehavior.scrollDepth = Math.max(
                userBehavior.scrollDepth,
                Math.floor((scrolled / totalHeight) * 100)
            );
        });

        document.addEventListener("click", () => {
            userBehavior.clicks++;
        });

        window.addEventListener("beforeunload", () => {
            userBehavior.timeSpent = Math.floor((Date.now() - timeStart) / 1000);
            localStorage.setItem("userBehavior", JSON.stringify(userBehavior));
        });

        // --- Cognitive Style Detection ---
        function detectUserCognitiveStyle() {
            const data = JSON.parse(localStorage.getItem("userBehavior")) || {};
            console.log("🧠 User Behavior Data:", data);

            let style;
            if (data.scrollDepth > 80 && data.clicks > 10 && data.timeSpent > 60) {
                style = "Detailed Explorer";
            } else if (data.clicks < 5 && data.scrollDepth < 40) {
                style = "Quick Scanner";
            } else {
                style = "Average";
            }

            localStorage.setItem("userStyle", style); // persist style
            console.log("🧠 Cognitive Style Detected:", style);
            return style;
        }

        // --- UI Adaptation ---
        function adaptUIForUser(style) {
            console.log(`🧠 UI Adapting for: ${style}`);

            if (style === "Quick Scanner") {
                document.body.style.backgroundColor = "#fff7ed";
                document.body.style.fontSize = "0.95rem";
                document.querySelectorAll(".product-card").forEach(card => {
                    card.style.border = "2px solid #f87171";
                });
            } else if (style === "Detailed Explorer") {
                document.body.style.backgroundColor = "#ecfeff";
                document.body.style.fontSize = "1.1rem";
                document.querySelectorAll(".product-card").forEach(card => {
                    card.style.boxShadow = "0 0 10px rgba(59,130,246,0.5)";
                });
            }
        }

        // --- Product Sorting by Style ---
        function sortProductsByStyle(products, style) {
            if (style === "Quick Scanner") {
                return products.sort((a, b) => a.price - b.price);
            } else if (style === "Detailed Explorer") {
                return products.sort((a, b) => {
                    if (a.category === "Electronics" && b.category !== "Electronics") return -1;
                    if (b.category === "Electronics" && a.category !== "Electronics") return 1;
                    return b.price - a.price;
                });
            }
            return products;
        }


        // --- Feedback Functions ---
        feedbackForm.addEventListener('submit', function(event) {
            event.preventDefault();

            const name = document.getElementById('feedbackName').value;
            const email = document.getElementById('feedbackEmail').value;
            const rating = document.getElementById('feedbackRating').value;
            const comments = document.getElementById('feedbackComments').value;

            if (!name || !email || !rating) {
                showModal('Error', 'Please fill in all required feedback fields.', 'error');
                return;
            }

            const newFeedback = {
                name,
                email,
                rating: parseInt(rating),
                comments,
                date: new Date().toLocaleDateString()
            };

            feedbackEntries.unshift(newFeedback); // Add to the beginning
            renderFeedback();
            feedbackForm.reset();
            showModal('Thank You!', 'Your feedback has been submitted successfully.', 'success');
        });

        function renderFeedback() {
            feedbackListDiv.innerHTML = '<h2 class="text-2xl font-bold text-gray-800 mb-4 text-center">Recent Feedback</h2>'; // Clear and re-add title
            if (feedbackEntries.length === 0) {
                noFeedbackMessage.classList.remove('hidden');
            } else {
                noFeedbackMessage.classList.add('hidden');
                feedbackEntries.forEach(entry => {
                    const stars = '⭐'.repeat(entry.rating);
                    // Get initials for the profile icon
                    const initials = entry.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                    const feedbackHtml = `
                        <div class="feedback-card bg-gray-50 p-4 rounded-lg shadow-sm mb-4">
                            <div class="flex items-center justify-between mb-2">
                                <div class="flex items-center space-x-3">
                                    <div class="profile-icon">${initials}</div>
                                    <span class="font-semibold text-gray-800 ml-3">${entry.name}</span>
                                </div>
                                <span class="text-sm text-gray-500">${entry.date}</span>
                            </div>
                            <div class="text-yellow-500 mb-2">${stars}</div>
                            <p class="text-gray-700">${entry.comments || 'No comments provided.'}</p>
                        </div>
                    `;
                    feedbackListDiv.innerHTML += feedbackHtml;
                });
            }
        }

        // --- Render Home Page Ratings ---
        function renderHomeRatings() {
            homeRatingsListDiv.innerHTML = ''; // Clear existing ratings

            // Display only the first 3 feedback entries for the home page
            const featuredRatings = feedbackEntries.slice(0, 3);

            if (featuredRatings.length === 0) {
                homeRatingsListDiv.innerHTML = '<p class="text-gray-500 text-center text-lg">No featured feedback yet.</p>';
            }
            else {
                featuredRatings.forEach(entry => {
                    const stars = '⭐'.repeat(entry.rating);
                    const initials = entry.name.split(' ').map(n => n[0]).join('').toUpperCase().substring(0, 2);
                    const feedbackHtml = `
                        <div class="feedback-card bg-white p-6 rounded-xl shadow-lg w-full sm:w-80 flex-shrink-0">
                            <div class="flex items-center space-x-3 mb-2">
                                <div class="flex items-center">
                                    <div class="profile-icon">${initials}</div>
                                    <span class="font-semibold text-gray-800 ml-3">${entry.name}</span>
                                </div>
                                <span class="text-sm text-gray-500">${entry.date}</span>
                            </div>
                            <div class="text-yellow-500 mb-2">${stars}</div>
                            <p class="text-gray-700 text-sm line-clamp-3">${entry.comments || 'No comments provided.'}</p>
                        </div>
                    `;
                    homeRatingsListDiv.innerHTML += feedbackHtml;
                });
            }
        }
        
        // --- Model Viewer Functions for Try-On ---
        function showTryOnPage(productId) {
            const tryOnPage = document.getElementById('try-on-page');
            const product = products.find(p => p.id === productId);
            
            if (!product || !product.modelPath) {
                console.error("Product or model path not found for ID:", productId);
                return;
            }

            // Set the src and ios-src for the main model-viewer
            mainModelViewer.setAttribute("src", product.modelPath);
            mainModelViewer.setAttribute("ios-src", product.modelPath.replace('.glb', '.usdz'));
            mainModelViewer.setAttribute("alt", `A 3D model of ${product.name}`);

            // Update the dropdown to match the selected product
            tryOnProductSelect.value = productId;
        }

        function populateTryOnProductSelect() {
            // Clear existing options
            tryOnProductSelect.innerHTML = '';
            
            // Add a default option
            const defaultOption = document.createElement('option');
            defaultOption.textContent = 'Select a product';
            defaultOption.value = '';
            tryOnProductSelect.appendChild(defaultOption);

            // Filter for products that have a modelPath
            const productsWithModels = products.filter(p => p.modelPath);
            
            productsWithModels.forEach(product => {
                const option = document.createElement('option');
                option.value = product.id;
                option.textContent = product.name;
                tryOnProductSelect.appendChild(option);
            });

            // Add event listener to handle changes
            tryOnProductSelect.addEventListener('change', (event) => {
                const selectedProductId = event.target.value;
                if (selectedProductId) {
                    showPage('try-on', parseInt(selectedProductId));
                }
            });
        }

        const savedCart = localStorage.getItem("cartData");
        if (savedCart) {
            cart = JSON.parse(savedCart);
        }

        function shuffleProducts(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // --- Initial Load ---
        window.onload = function () {
            const style = detectUserCognitiveStyle();
            adaptUIForUser(style);

            // 🔀 Randomize products
            shuffleProducts(products);

            // Optional: sort by style AFTER shuffle
            products = sortProductsByStyle(products, style);

            // Set data-category attribute for buttons
            document.querySelectorAll('.category-button').forEach(button => {
                button.setAttribute('data-category', button.textContent.trim());
            });

            const initialPage = window.location.hash.replace('#', '') || 'home';
            
            showPage(initialPage); // will call filterProducts and render
            updateCartUI();
        };


        window.onhashchange = function () {
            const hash = window.location.hash.replace('#', '') || 'home';
            showPage(hash);
        };

        window.addEventListener("load", () => {
            const loader = document.getElementById("loading-screen");
            const skeleton = document.getElementById("skeleton-preview");

            // Fade out the loader and skeleton immediately
            loader.classList.add("opacity-0", "pointer-events-none");
            skeleton.classList.add("opacity-0");

            // After the fade, fully remove the loader
            setTimeout(() => {
                loader.style.display = "none";
                document.querySelectorAll('.page').forEach(page => page.classList.remove('hidden'));
                showPage("home");
            }, 500);
        });

    </script>
</body>
</html>